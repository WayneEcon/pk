2025-08-19 20:16:32,062 - INFO - ⚠️ wbdata暂时禁用，将使用缓存的宏观数据
2025-08-19 20:16:32,095 - INFO - ✅ requests库可用，将使用EIA API
2025-08-19 20:16:33,076 - INFO - ✅ 滤波库可用，将使用HP滤波
2025-08-19 20:16:33,077 - INFO - 🏗️ 变量构建器初始化完成
2025-08-19 20:16:33,077 - INFO -    项目根目录: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network
2025-08-19 20:16:33,077 - INFO -    输出目录: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network/src/08_variable_construction/outputs
2025-08-19 20:16:40,610 - INFO - ⚠️ wbdata暂时禁用，将使用缓存的宏观数据
2025-08-19 20:16:40,652 - INFO - ✅ requests库可用，将使用EIA API
2025-08-19 20:16:41,059 - INFO - ✅ 滤波库可用，将使用HP滤波
2025-08-19 20:16:41,060 - INFO - 🏗️ 变量构建器初始化完成
2025-08-19 20:16:41,060 - INFO -    项目根目录: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network
2025-08-19 20:16:41,060 - INFO -    输出目录: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network/src/08_variable_construction/outputs
2025-08-19 20:16:41,060 - INFO - ⚙️ 开始构建核心变量...
2025-08-19 20:16:41,060 - INFO -    构建 Node-DLI_US...
2025-08-19 20:16:41,060 - WARNING - ⚠️ 缺少DLI或贸易数据，跳过Node-DLI_US构建
2025-08-19 20:16:41,060 - INFO -    构建 Vul_US...
2025-08-19 20:16:41,060 - WARNING - ⚠️ 缺少贸易数据，跳过Vul_US构建
2025-08-19 20:16:41,060 - INFO - 🚀 开始构建完整OVI时间序列...
2025-08-19 20:16:41,060 - INFO - === 构建天然气OVI时间序列 ===
2025-08-19 20:16:41,060 - INFO - 步骤1: 处理LNG接收站时间序列数据...
2025-08-19 20:16:41,633 - INFO - LNG时间序列完成: 1175条记录，47个国家
2025-08-19 20:16:41,633 - INFO - 步骤2: 处理天然气管道时间序列数据...
2025-08-19 20:16:42,530 - INFO - 管道时间序列完成: 1875条记录，75个国家
2025-08-19 20:16:42,530 - INFO - 步骤3: 处理天然气消费时间序列数据...
2025-08-19 20:16:42,881 - INFO - 天然气消费时间序列完成: 2325条记录
2025-08-19 20:16:42,881 - INFO - 步骤4: 合并天然气时间序列数据...
2025-08-19 20:16:42,929 - INFO - ✅ 天然气OVI时间序列完成: 1015条记录
2025-08-19 20:16:42,929 - INFO - === 构建石油OVI时间序列 ===
2025-08-19 20:16:42,929 - INFO - 石油OVI构建跳过（稳健性检验指标）
2025-08-19 20:16:42,935 - INFO - ✅ 天然气OVI保存完成: 1015条记录
2025-08-19 20:16:42,935 - INFO - ✅ OVI_gas 时间序列已生成: 1015 行
2025-08-19 20:16:42,935 - INFO - ✅ OVI_oil 时间序列已生成: 0 行
2025-08-19 20:16:42,935 - INFO -    构建综合US_ProdShock（原油+天然气）...
2025-08-19 20:16:42,935 - INFO -    使用EIA API Key: kCKMXECZ...
2025-08-19 20:16:42,935 - INFO -    获取美国原油产量数据...
2025-08-19 20:16:46,728 - INFO -    原油数据: 23 年，范围 2001-2023
2025-08-19 20:16:46,728 - INFO -    获取美国天然气产量数据...
2025-08-19 20:16:48,914 - INFO -    天然气数据: 23 年，范围 2001-2023
2025-08-19 20:16:48,916 - INFO -    计算HP滤波冲击...
2025-08-19 20:16:48,922 - INFO - ✅ 综合US_ProdShock构建完成: 23 年数据
2025-08-19 20:16:48,922 - INFO -    原油产量范围: 188365 - 1404089
2025-08-19 20:16:48,922 - INFO -    天然气产量范围: 1291009 - 44961277
2025-08-19 20:16:48,922 - INFO -    综合冲击范围: -1.786 - 1.966
2025-08-19 20:16:48,923 - INFO - ✅ 核心变量构建完成，共 3 个变量
2025-08-19 20:16:55,006 - INFO - ⚠️ wbdata暂时禁用，将使用缓存的宏观数据
2025-08-19 20:16:55,048 - INFO - ✅ requests库可用，将使用EIA API
2025-08-19 20:16:55,431 - INFO - ✅ 滤波库可用，将使用HP滤波
2025-08-19 20:16:55,431 - INFO - 🏗️ 变量构建器初始化完成
2025-08-19 20:16:55,431 - INFO -    项目根目录: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network
2025-08-19 20:16:55,431 - INFO -    输出目录: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network/src/08_variable_construction/outputs
2025-08-19 20:16:55,431 - INFO - 🚀 开始运行完整的变量构建流水线...
2025-08-19 20:16:55,431 - INFO - 
==================================================
2025-08-19 20:16:55,431 - INFO - 步骤1: 搜集宏观经济控制变量
2025-08-19 20:16:55,431 - INFO - ==================================================
2025-08-19 20:16:55,431 - INFO - 🌍 开始搜集宏观经济控制变量...
2025-08-19 20:16:55,431 - INFO -    从缓存加载宏观数据...
2025-08-19 20:16:55,440 - INFO - ✅ 从缓存加载宏观数据: 500 行记录
2025-08-19 20:16:55,440 - INFO -    数据范围: 2000-2024
2025-08-19 20:16:55,440 - INFO - 
==================================================
2025-08-19 20:16:55,440 - INFO - 步骤2: 加载基础数据
2025-08-19 20:16:55,440 - INFO - ==================================================
2025-08-19 20:16:55,440 - INFO - 📁 开始加载基础数据...
2025-08-19 20:16:56,272 - INFO - ✅ 加载贸易流数据: 合并 24 个文件 (503434 行)
2025-08-19 20:16:56,284 - INFO - ✅ 加载节点指标: 5476 行
2025-08-19 20:16:56,286 - INFO - ✅ 加载全局指标: 24 行
2025-08-19 20:16:56,366 - INFO - ✅ 加载DLI面板数据: 41349 行
2025-08-19 20:16:56,367 - INFO - ✅ 基础数据加载完成，共 4 个数据集
2025-08-19 20:16:56,384 - INFO - 
==================================================
2025-08-19 20:16:56,384 - INFO - 步骤3: 构建核心变量
2025-08-19 20:16:56,384 - INFO - ==================================================
2025-08-19 20:16:56,384 - INFO - ⚙️ 开始构建核心变量...
2025-08-19 20:16:56,384 - INFO -    构建 Node-DLI_US...
2025-08-19 20:16:56,526 - INFO -    计算真实贸易份额...
2025-08-19 20:16:56,621 - INFO -    计算了 3972 个国家-年份的真实贸易份额
2025-08-19 20:16:56,621 - INFO -    基于真实DLI数据构建Node-DLI_US...
2025-08-19 20:17:29,310 - INFO -    有效DLI记录: 3740/3972
2025-08-19 20:17:29,310 - INFO -    Node-DLI_US范围: 0.000 - 3.390
2025-08-19 20:17:29,311 - INFO -    平均进口份额: 0.100
2025-08-19 20:17:29,340 - INFO - ✅ 真实Node-DLI_US构建完成: 3972 行记录
2025-08-19 20:17:29,355 - INFO -    构建 Vul_US...
2025-08-19 20:17:30,077 - INFO - ✅ Vul_US构建完成: 3721 行记录
2025-08-19 20:17:30,089 - INFO - 🚀 开始构建完整OVI时间序列...
2025-08-19 20:17:30,089 - INFO - === 构建天然气OVI时间序列 ===
2025-08-19 20:17:30,089 - INFO - 步骤1: 处理LNG接收站时间序列数据...
2025-08-19 20:17:30,747 - INFO - LNG时间序列完成: 1175条记录，47个国家
2025-08-19 20:17:30,747 - INFO - 步骤2: 处理天然气管道时间序列数据...
2025-08-19 20:17:31,914 - INFO - 管道时间序列完成: 1875条记录，75个国家
2025-08-19 20:17:31,914 - INFO - 步骤3: 处理天然气消费时间序列数据...
2025-08-19 20:17:32,250 - INFO - 天然气消费时间序列完成: 2325条记录
2025-08-19 20:17:32,250 - INFO - 步骤4: 合并天然气时间序列数据...
2025-08-19 20:17:32,295 - INFO - ✅ 天然气OVI时间序列完成: 1015条记录
2025-08-19 20:17:32,296 - INFO - === 构建石油OVI时间序列 ===
2025-08-19 20:17:32,296 - INFO - 石油OVI构建跳过（稳健性检验指标）
2025-08-19 20:17:32,300 - INFO - ✅ 天然气OVI保存完成: 1015条记录
2025-08-19 20:17:32,300 - INFO - ✅ OVI_gas 时间序列已生成: 1015 行
2025-08-19 20:17:32,300 - INFO - ✅ OVI_oil 时间序列已生成: 0 行
2025-08-19 20:17:32,300 - INFO -    构建综合US_ProdShock（原油+天然气）...
2025-08-19 20:17:32,300 - INFO -    使用EIA API Key: kCKMXECZ...
2025-08-19 20:17:32,300 - INFO -    获取美国原油产量数据...
2025-08-19 20:17:34,174 - INFO -    原油数据: 23 年，范围 2001-2023
2025-08-19 20:17:34,174 - INFO -    获取美国天然气产量数据...
2025-08-19 20:17:36,276 - INFO -    天然气数据: 23 年，范围 2001-2023
2025-08-19 20:17:36,277 - INFO -    计算HP滤波冲击...
2025-08-19 20:17:36,280 - INFO - ✅ 综合US_ProdShock构建完成: 23 年数据
2025-08-19 20:17:36,280 - INFO -    原油产量范围: 188365 - 1404089
2025-08-19 20:17:36,280 - INFO -    天然气产量范围: 1291009 - 44961277
2025-08-19 20:17:36,280 - INFO -    综合冲击范围: -1.786 - 1.966
2025-08-19 20:17:36,281 - INFO - ✅ 核心变量构建完成，共 5 个变量
2025-08-19 20:17:36,281 - INFO - 
==================================================
2025-08-19 20:17:36,281 - INFO - 步骤4: 创建最终分析面板
2025-08-19 20:17:36,281 - INFO - ==================================================
2025-08-19 20:17:36,281 - INFO - 🔗 开始创建最终分析面板...
2025-08-19 20:17:36,282 - INFO -    从country_name提取country列: 18 个国家
2025-08-19 20:17:36,282 - INFO -    基于宏观数据构建起始面板: 500 行
2025-08-19 20:17:36,282 - INFO -    起始面板: 500 行
2025-08-19 20:17:36,283 - INFO -    ✅ 合并 node_dli_us: 3972 行
2025-08-19 20:17:36,285 - INFO -    ✅ 合并 vul_us: 3721 行
2025-08-19 20:17:36,286 - INFO -    ✅ 合并 ovi_gas: 1015 行
2025-08-19 20:17:36,287 - INFO -    ✅ 合并 us_prod_shock: 23 行
2025-08-19 20:17:36,289 - INFO -    ✅ 合并网络指标: 5476 行
2025-08-19 20:17:36,289 - INFO -    清洗最终面板数据...
2025-08-19 20:17:36,311 - INFO - ✅ 最终分析面板创建完成:
2025-08-19 20:17:36,312 - INFO -    行数: 500
2025-08-19 20:17:36,312 - INFO -    列数: 34
2025-08-19 20:17:36,312 - INFO -    年份范围: 2000-2024
2025-08-19 20:17:36,312 - INFO -    国家数量: 20
2025-08-19 20:17:36,312 - INFO -    成功合并: 5 个数据集
2025-08-19 20:17:36,312 - INFO -    保存至: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network/data/processed_data/analytical_panel.csv
2025-08-19 20:17:36,312 - INFO - 
==================================================
2025-08-19 20:17:36,312 - INFO - 步骤5: 生成数据字典
2025-08-19 20:17:36,312 - INFO - ==================================================
2025-08-19 20:17:36,312 - INFO - 📖 创建数据字典...
2025-08-19 20:17:36,341 - INFO - ✅ 数据字典创建完成: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network/src/08_variable_construction/outputs/data_dictionary.md
2025-08-19 20:17:36,341 - INFO - 
============================================================
2025-08-19 20:17:36,341 - INFO - 🎉 变量构建流水线执行完成！
2025-08-19 20:17:36,341 - INFO - ============================================================
2025-08-19 20:17:36,341 - INFO - ✅ 最终输出:
2025-08-19 20:17:36,341 - INFO -    - 分析面板: analytical_panel.csv (500 行)
2025-08-19 20:17:36,341 - INFO -    - 数据字典: data_dictionary.md
2025-08-19 20:17:36,341 - INFO -    - 中间文件: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network/src/08_variable_construction/08data
2025-08-19 20:17:36,341 - INFO -    - 输出目录: /Users/ywz/Desktop/pku/美国能源独立/project/energy_network/src/08_variable_construction/outputs
